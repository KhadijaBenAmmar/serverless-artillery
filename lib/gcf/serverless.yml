service: serverless-artillery-gcf # NOTE: Don't put the word "google" in here

provider:
  # environment:
  #   DATADOG_API_KEY: "*******"
  name: google
  runtime: nodejs8
  region: ${opt:region, 'us-central1'}
  memorySize: 2048
  # the credentials can be provided as a command line argument, or read from env, or fallback to a default file
  # location
  credentials: ${opt:google-creds-file, env:GOOGLE_APPLICATION_CREDENTIALS, '~/.gcloud/keyfile.json'}
  # read the project_id from the credentials file using the self.provider.credentials
  project: ${file(${self:provider.credentials}):project_id, 'algoan-dev'}
plugins:
  - serverless-google-cloudfunctions
  # - artillery-plugin-datadog

# needs more granular excluding in production as only the serverless provider npm
# package should be excluded (and not the whole node_modules directory)
package:
  include:
    - serverless.yml
  exclude:
    - node_modules/**
    - .gitignore
    - .git/**
functions:
  loadGenerator:
      handler: loadGenerator
      timeout: 300s
      events:
        - http: path
